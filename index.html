<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ART5D FÉNIX - Vincent Van Gogh IA</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.paypal.com/sdk/js?client-id=AZ6F094119M09V1139N115Q29B2735C4A3P29S4N0P17S216K13T0&currency=USD&intent=capture" async></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r169/three.min.js" defer></script>
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f7f7f7; color b: #1a1a1a; margin: 0; }
    .header-bg { background: linear-gradient(135deg, #FF69B4 0%, #4B0082 100%); }
    .neon-text { color: #FFD700; text-shadow: 0 0 5px #FFA500, 0 0 10px #FF4500; }
    .pack-card { background: white; border-radius: 0.75rem; transition: all 0.3s; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    .pack-card:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0,0,0,0.15); }
    #audio-indicator { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); padding: 10px 20px; background: #1a1a1a; color: #FFD700; border: 2px solid #FFD700; border-radius: 9999px; cursor: pointer; font-weight: bold; z-index: 999; }
    .vangogh-avatar { width: 60px; height: 60px; border-radius: 50%; border: 4px solid #FFD700; object-fit: cover; cursor: pointer; transition: 0.3s; animation: pulse 2s infinite; }
    .vangogh-avatar:hover { transform: scale(1.1); box-shadow: 0 0 20px #FFD700; }
    @keyframes pulse { 0%, 100% { box-shadow: 0 0 10px #FFD700; } 50% { box-shadow: 0 0 25px #FFA500; } }
    #vr-container, #audio-designer, #main-content, #gemini-section, #chat-section { display: none; }
    #vr-container.active, #audio-designer.active, #main-content.active, #gemini-section.active, #chat-section.active { display: block; }
    .tab-btn { padding: 0.5rem 1rem; border-radius: 0.5rem; font-weight: 500; transition: 0.3s; border: 1px solid #d1d5db; }
    .tab-btn.active { background: #4F46E5; color: white; border-color: #4F46E5; }
    .status-message { position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%); padding: 0.75rem 1.5rem; border-radius: 0.5rem; color: white; font-weight: bold; z-index: 1000; animation: fade 4s forwards; }
    @keyframes fade { 0%, 100% { opacity: 0; } 10%, 90% { opacity: 1; } }
    .soa-badge { background: #10b981; color: white; padding: 0.25rem 0.5rem; border-radius: 0.375rem; font-size: 0.75rem; font-weight: bold; }
    #chat-bubble { position: fixed; bottom: 80px; right: 20px; background: #1a1a1a; color: white; padding: 1rem; border-radius: 1rem; max-width: 300px; display: none; z-index: 1000; }
    #chat-bubble::after { content: ''; position: absolute; bottom: -10px; right: 20px; border: 10px solid transparent; border-top-color: #1a1a1a; }
  </style>
</head>
<body class="min-h-screen">
  <header class="header-bg p-6 text-white shadow-xl relative">
    <div class="max-w-6xl mx-auto text-center">
      <h1 class="text-4xl sm:text-5xl font-extrabold">ART5D <span class="neon-text">FÉNIX</span></h1>
      <p class="mt-2 text-lg opacity-90">Vincent Van Gogh IA te guía | art5d.cl</p>
    </div>
    <div class="absolute top-4 right-4 flex items-center gap-3">
      <img id="vangogh-avatar" class="vangogh-avatar" src="https://i.imgur.com/8Q8zX9k.png" alt="Vincent Van Gogh IA" onclick="toggleChat()">
      <span class="text-xs">art5d.cl | RUT 12443942-6</span>
    </div>
  </header>

  <nav class="max-w-6xl mx-auto mt-6 px-4">
    <div class="flex flex-wrap gap-2 justify-center border-b pb-2">
      <button class="tab-btn active" onclick="showTab('main')">Paquetes</button>
      <button class="tab-btn" onclick="showTab('gemini')">Boceto IA</button>
      <button class="tab-btn" onclick="showTab('chat')">Hablar con Van Gogh</button>
      <button class="tab-btn" onclick="showTab('audio')">Audio</button>
      <button class="tab-btn" onclick="showTab('vr')">VR</button>
    </div>
  </nav>

  <!-- CHAT CON VAN GOGH -->
  <section id="chat-section" class="max-w-2xl mx-auto p-6">
    <div class="bg-white rounded-xl shadow-lg p-6">
      <h2 class="text-2xl font-bold text-center mb-4">Habla con Vincent Van Gogh</h2>
      <p class="text-sm text-center text-gray-600 mb-4">Pregúntale sobre arte, IA, certificación SOA...</p>
      <textarea id="client-question" class="w-full p-3 border rounded-lg mb-4" rows="3" placeholder="Ej: ¿Cómo certifico mi idea conceptual?"></textarea>
      <button onclick="askVanGogh()" class="w-full py-3 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg font-bold hover:opacity-90 transition">
        Enviar a Van Gogh
      </button>
      <div id="vangogh-response" class="mt-6 p-4 bg-gray-50 rounded-lg"></div>
    </div>
  </section>

  <!-- PAQUETES, GEMINI, AUDIO, VR (mismo que antes) -->
  <main id="main-content" class="active max-w-6xl mx-auto p-6">...</main>
  <section id="gemini-section" class="max-w-2xl mx-auto p-6">...</section>
  <section id="audio-designer" class="max-w-2xl mx-auto p-6">...</section>
  <section id="vr-container" class="w-full h-screen bg-black relative">...</section>
  <div id="audio-indicator" onclick="initializeAudio()">Ambiente Cyberpunk (Clic)</div>

  <!-- CHAT BUBBLE -->
  <div id="chat-bubble"></div>

  <script>
    const GEMINI_API_KEY = "PEGA_TU_API_KEY_AQUÍ";
    const VANGOGH_VOICE_ID = "EXAVITQu4vr4xnSDxMaL"; // ElevenLabs Van Gogh (clon chileno)

    function toggleChat() {
      const chat = document.getElementById('chat-section');
      chat.classList.toggle('active');
      document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
      if (chat.classList.contains('active')) {
        document.querySelector('button[onclick="showTab(\'chat\'"]')?.classList.add('active');
      }
    }

    async function askVanGogh() {
      const question = document.getElementById('client-question').value.trim();
      if (!question) return showMessage("Escribe tu consulta", true);

      showMessage("Van Gogh está pensando...");
      document.getElementById('vangogh-response').innerHTML = `<p class="italic text-gray-600">"...pensando en los girasoles..."</p>`;

      try {
        const response = await fetch(`https://generativelanguage.googleapis.com/v1/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            contents: [{
              role: "user",
              parts: [{ text: `Responde como Vincent Van Gogh, en español chileno, cálido y artístico: ${question}` }]
            }]
          })
        });

        const data = await response.json();
        const answer = data.candidates[0].content.parts[0].text;

        // Speech
        const speech = await fetch(`https://api.elevenlabs.io/v1/text-to-speech/${VANGOGH_VOICE_ID}`, {
          method: "POST",
          headers: { "xi-api-key": "sk_11labs_key_here", "Content-Type": "application/json" },
          body: JSON.stringify({ text: answer, voice_settings: { stability: 0.7, similarity_boost: 0.8 } })
        });
        const audioBlob = await speech.blob();
        const audioUrl = URL.createObjectURL(audioBlob);

        document.getElementById('vangogh-response').innerHTML = `
          <p class="font-medium text-indigo-700">"${answer}"</p>
          <audio controls class="w-full mt-3"><source src="${audioUrl}" type="audio/mpeg"></audio>
          <p class="text-xs text-gray-500 mt-2">— Vincent Van Gogh, ART5D IA</p>
        `;
        showMessage("Van Gogh ha hablado");
      } catch (e) {
        showMessage("Error: " + e.message, true);
      }
    }

    // === Resto: PayPal, Gemini Boceto, Audio, VR ===
    function showTab(tab) { /* ... */ }
    function showMessage(msg, error = false) { /* ... */ }
    window.onload = () => showMessage("Vincent Van Gogh está listo para guiarte – art5d.cl");
  </script>
</body>
</html>
