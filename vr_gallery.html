<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ART5D FÉNIX - Galería de Arte VR</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Carga de Three.js para la funcionalidad 3D -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background-color: #0A0A0A; }
        #vr-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        canvas { display: block; }
        #info-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            padding: 1rem;
            text-align: center;
            color: white;
            background: rgba(0, 0, 0, 0.7);
            font-family: 'Inter', sans-serif;
            z-index: 10;
            border-bottom-left-radius: 0.75rem;
            border-bottom-right-radius: 0.75rem;
        }
    </style>
</head>
<body>
    <div id="vr-container">
        <!-- El canvas 3D se insertará aquí -->
    </div>

    <!-- Overlay de Instrucciones -->
    <div id="info-overlay">
        <h1 class="text-xl font-bold text-accent-light">Galería Virtual ART5D FÉNIX (Visor 3D)</h1>
        <p class="text-sm text-gray-400">
            Utiliza el **mouse** (mantén presionado el botón izquierdo) para **rotar la cámara** y mirar alrededor de la sala.
            <span class="font-semibold text-accent-phoenix block mt-1">Este es el formato de Galería VR para los Packs GOLD y PLATINO.</span>
        </p>
    </div>

    <script>
        // Configuración de Tailwind para Three.js (no directamente aplicable, solo por consistencia)
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'accent-phoenix': '#A855F7',
                        'accent-light': '#FDBA74',
                    }
                }
            }
        }

        let scene, camera, renderer, controls;
        let isDragging = false;
        let previousMousePosition = {
            x: 0,
            y: 0
        };

        // --- Inicialización del Escenario 3D ---
        function init() {
            // 1. Scene (Escena)
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x111111); // Fondo muy oscuro

            // 2. Camera (Cámara)
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 1.6, 5); // Posición inicial del observador (1.6m de altura)

            // 3. Renderer (Renderizador)
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            document.getElementById('vr-container').appendChild(renderer.domElement);

            // 4. Lights (Luces)
            const ambientLight = new THREE.AmbientLight(0x404040, 5); // Luz suave
            scene.add(ambientLight);
            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(5, 5, 5);
            scene.add(directionalLight);

            // 5. Build the Gallery (Construir la Galería)
            createGalleryRoom();
            addArtSlots();

            // 6. Event Listeners for Interaction (Oyentes de Eventos para Interacción)
            addInteractionControls();
            window.addEventListener('resize', onWindowResize, false);
        }

        // --- Construcción de la Sala de Galería ---
        function createGalleryRoom() {
            const roomSize = 10; // 10x10 metros

            // Floor (Piso)
            const floorGeometry = new THREE.PlaneGeometry(roomSize, roomSize);
            const floorMaterial = new THREE.MeshLambertMaterial({ color: 0x222222 }); // Gris oscuro
            const floor = new THREE.Mesh(floorGeometry, floorMaterial);
            floor.rotation.x = -Math.PI / 2;
            floor.position.y = 0;
            scene.add(floor);

            // Walls (Paredes) - Material Liso
            const wallMaterial = new THREE.MeshLambertMaterial({ color: 0x333333 }); // Gris medio

            // Back Wall
            const backWall = new THREE.Mesh(new THREE.PlaneGeometry(roomSize, 4), wallMaterial);
            backWall.position.set(0, 2, -roomSize / 2);
            scene.add(backWall);

            // Left Wall
            const leftWall = new THREE.Mesh(new THREE.PlaneGeometry(roomSize, 4), wallMaterial);
            leftWall.rotation.y = Math.PI / 2;
            leftWall.position.set(-roomSize / 2, 2, 0);
            scene.add(leftWall);

            // Right Wall
            const rightWall = new THREE.Mesh(new THREE.PlaneGeometry(roomSize, 4), wallMaterial);
            rightWall.rotation.y = -Math.PI / 2;
            rightWall.position.set(roomSize / 2, 2, 0);
            scene.add(rightWall);

            // Ceiling (Techo)
            const ceiling = new THREE.Mesh(new THREE.PlaneGeometry(roomSize, roomSize), wallMaterial);
            ceiling.rotation.x = Math.PI / 2;
            ceiling.position.y = 4;
            scene.add(ceiling);
        }

        // --- Añadir Slots de Arte (Placeholders) ---
        function addArtSlots() {
            const artWidth = 1.5;
            const artHeight = 1.0;
            const artDepth = 0.05;

            // Materiales de ejemplo (representan diferentes obras/slots)
            const material1 = new THREE.MeshLambertMaterial({ color: 0xA855F7 }); // Púrpura Fénix (Obra Original)
            const material2 = new THREE.MeshLambertMaterial({ color: 0xFDBA74 }); // Naranja (Boceto IA)

            // Geometría del marco
            const geometry = new THREE.BoxGeometry(artWidth, artHeight, artDepth);

            // Slots en la Pared Trasera (-Z)
            const positionsZ = [-3, 0, 3]; // X positions
            positionsZ.forEach((x, index) => {
                const material = (index % 2 === 0) ? material1 : material2;
                const art = new THREE.Mesh(geometry, material);
                art.position.set(x, 2, -4.9);
                scene.add(art);
            });

            // Slots en la Pared Izquierda (-X)
            const positionsX = [-3, 3]; // Z positions
            positionsX.forEach((z, index) => {
                const material = (index % 2 === 0) ? material2 : material1;
                const art = new THREE.Mesh(geometry, material);
                art.rotation.y = Math.PI / 2;
                art.position.set(-4.9, 2, z);
                scene.add(art);
            });
        }

        // --- Controles de Interacción con Mouse (Rotación) ---
        function addInteractionControls() {
            renderer.domElement.addEventListener('mousedown', onMouseDown, false);
            renderer.domElement.addEventListener('mousemove', onMouseMove, false);
            renderer.domElement.addEventListener('mouseup', onMouseUp, false);
            renderer.domElement.addEventListener('wheel', onMouseWheel, false);
        }

        function onMouseDown(event) {
            isDragging = true;
            previousMousePosition.x = event.clientX;
            previousMousePosition.y = event.clientY;
        }

        function onMouseUp() {
            isDragging = false;
        }

        function onMouseMove(event) {
            if (!isDragging) return;

            const deltaX = event.clientX - previousMousePosition.x;
            const deltaY = event.clientY - previousMousePosition.y;

            // Rotación Horizontal (Yaw) alrededor del eje Y
            const rotationSpeed = 0.005;
            camera.rotation.y -= deltaX * rotationSpeed;

            // Rotación Vertical (Pitch) alrededor del eje X local
            const pitchChange = deltaY * rotationSpeed;
            // Limitar la rotación vertical para evitar voltear la cámara
            let rotationX = camera.rotation.x + pitchChange;
            rotationX = Math.max(-Math.PI / 2, Math.min(Math.PI / 2, rotationX)); // Limita a 90 grados arriba/abajo
            camera.rotation.x = rotationX;

            previousMousePosition.x = event.clientX;
            previousMousePosition.y = event.clientY;
        }

        // Simula acercamiento/alejamiento básico (Zoom/Move Z)
        function onMouseWheel(event) {
            const zoomSpeed = 0.05;
            camera.position.z += event.deltaY * zoomSpeed * 0.01;
            // Limitar el movimiento para no salir de la sala
            camera.position.z = Math.max(-4.5, Math.min(4.5, camera.position.z));
            event.preventDefault();
        }

        // --- Loop de Animación ---
        function animate() {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        }

        // --- Manejo de Redimensionamiento ---
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        // Inicia la aplicación 3D al cargar la ventana
        window.onload = function () {
            init();
            animate();
        };
    </script>
</body>
</html>
